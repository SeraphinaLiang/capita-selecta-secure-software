TARGET = smash.elf
TARGET_BIN = smash.bin
TARGET_IHEX = smash.ihex

SHELLCODE = shellcode.elf
SHELLCODE_BIN = shellcode.bin

.SECONDARY:

all: $(TARGET_BIN) $(TARGET_IHEX) $(SHELLCODE_BIN)

KERNEL_DIR = ../Tools/Kernel
include $(KERNEL_DIR)/Makefile.include

shellcode.elf: shellcode.o
	$(CC) -ffreestanding -nostdlib -T shellcode.ld -o $@ $^

clean: clean_kernel
	rm -f $(TARGET) $(TARGET:.elf=.o) $(TARGET_BIN) $(TARGET_IHEX) $(SHELLCODE) $(SHELLCODE:.elf=.o) $(SHELLCODE_BIN) $(KERNEL_GENERATED_FILES)
